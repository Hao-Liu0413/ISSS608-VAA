{
  "hash": "6672fa84288ee3e52b24fb85492f8ebc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take_Home_Exercise01_part2\"\nauthor: Hao Liu\ndate: \"May 8, 2025\"\ndate-modified: \"last-modified\"\nformat: html\neditor: visual\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n## Part 2: Comment on classmate submission (author: FU YILIN)\n\n### Original Visualization\n\n::: callout-note\nwebsite link:\n\n*https://isss608-ay2025t2.netlify.app/take-home_ex/take-home_ex01/take-home_ex01*\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, ggplot2, dplyr, forcats, ggthemes, patchwork, knitr, gt)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read_csv(\"respopagesex2024.csv\") %>%\n  mutate(Age = ifelse(Age == \"90_and_Over\", \"95\", Age),\n         Age = as.numeric(Age)) %>%\n  drop_na(Age)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(duplicated(data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata[duplicated(data), ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 6\n# ℹ 6 variables: PA <chr>, SZ <chr>, Age <dbl>, Sex <chr>, Pop <dbl>,\n#   Time <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngrouped <- data %>%\n  select(PA, SZ) %>%\n  distinct() %>%\n  arrange(PA, SZ) %>%\n  group_by(PA) %>%\n  summarise(Subzones = paste(SZ, collapse = \", \"))\n\ngrouped %>%\n  gt() %>%\n  tab_header(\n    title = \"Planning Areas and Their Subzones\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mmcnmqwmyh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mmcnmqwmyh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mmcnmqwmyh thead, #mmcnmqwmyh tbody, #mmcnmqwmyh tfoot, #mmcnmqwmyh tr, #mmcnmqwmyh td, #mmcnmqwmyh th {\n  border-style: none;\n}\n\n#mmcnmqwmyh p {\n  margin: 0;\n  padding: 0;\n}\n\n#mmcnmqwmyh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mmcnmqwmyh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mmcnmqwmyh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mmcnmqwmyh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mmcnmqwmyh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mmcnmqwmyh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mmcnmqwmyh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mmcnmqwmyh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mmcnmqwmyh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mmcnmqwmyh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mmcnmqwmyh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mmcnmqwmyh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mmcnmqwmyh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mmcnmqwmyh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mmcnmqwmyh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmcnmqwmyh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mmcnmqwmyh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mmcnmqwmyh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mmcnmqwmyh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmcnmqwmyh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mmcnmqwmyh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmcnmqwmyh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mmcnmqwmyh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmcnmqwmyh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mmcnmqwmyh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmcnmqwmyh .gt_left {\n  text-align: left;\n}\n\n#mmcnmqwmyh .gt_center {\n  text-align: center;\n}\n\n#mmcnmqwmyh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mmcnmqwmyh .gt_font_normal {\n  font-weight: normal;\n}\n\n#mmcnmqwmyh .gt_font_bold {\n  font-weight: bold;\n}\n\n#mmcnmqwmyh .gt_font_italic {\n  font-style: italic;\n}\n\n#mmcnmqwmyh .gt_super {\n  font-size: 65%;\n}\n\n#mmcnmqwmyh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mmcnmqwmyh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mmcnmqwmyh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mmcnmqwmyh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mmcnmqwmyh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mmcnmqwmyh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mmcnmqwmyh .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mmcnmqwmyh .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mmcnmqwmyh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Planning Areas and Their Subzones</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"PA\">PA</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Subzones\">Subzones</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Ang Mo Kio</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Ang Mo Kio Town Centre, Cheng San, Chong Boon, Kebun Bahru, Sembawang Hills, Shangri-La, Tagore, Townsville, Yio Chu Kang, Yio Chu Kang East, Yio Chu Kang North, Yio Chu Kang West</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Bedok</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bayshore, Bedok North, Bedok Reservoir, Bedok South, Frankel, Kaki Bukit, Kembangan, Siglap</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Bishan</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bishan East, Marymount, Upper Thomson</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Boon Lay</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Liu Fang, Samulun, Shipyard, Tukang</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Bukit Batok</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Brickworks, Bukit Batok Central, Bukit Batok East, Bukit Batok South, Bukit Batok West, Gombak, Guilin, Hillview, Hong Kah North</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Bukit Merah</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Alexandra Hill, Alexandra North, Bukit Ho Swee, Bukit Merah, City Terminals, Depot Road, Everton Park, Henderson Hill, Kampong Tiong Bahru, Maritime Square, Redhill, Singapore General Hospital, Telok Blangah Drive, Telok Blangah Rise, Telok Blangah Way, Tiong Bahru, Tiong Bahru Station</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Bukit Panjang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bangkit, Dairy Farm, Fajar, Jelebu, Nature Reserve, Saujana, Senja</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Bukit Timah</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Anak Bukit, Coronation Road, Farrer Court, Hillcrest, Holland Road, Leedon Park, Swiss Club, Ulu Pandan</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Central Water Catchment</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Central Water Catchment</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Changi</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Changi Airport, Changi Point, Changi West</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Changi Bay</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Changi Bay</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Choa Chu Kang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Choa Chu Kang Central, Choa Chu Kang North, Keat Hong, Peng Siang, Teck Whye, Yew Tee</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Clementi</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Clementi Central, Clementi North, Clementi West, Clementi Woods, Faber, Pandan, Sunset Way, Toh Tuck, West Coast</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Downtown Core</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Anson, Bayfront Subzone, Bugis, Cecil, Central Subzone, City Hall, Clifford Pier, Marina Centre, Maxwell, Nicoll, Phillip, Raffles Place, Tanjong Pagar</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Geylang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Aljunied, Geylang East, Kallang Way, Kampong Ubi, Macpherson</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Hougang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Defu Industrial Park, Hougang Central, Hougang East, Hougang West, Kangkar, Kovan, Lorong Ah Soo, Lorong Halus, Tai Seng, Trafalgar</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Jurong East</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">International Business Park, Jurong Gateway, Jurong Port, Jurong River, Lakeside (Business), Lakeside (Leisure), Penjuru Crescent, Teban Gardens, Toh Guan, Yuhua East, Yuhua West</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Jurong West</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Boon Lay Place, Chin Bee, Hong Kah, Jurong West Central, Kian Teck, Safti, Taman Jurong, Wenya, Yunnan</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Kallang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bendemeer, Boon Keng, Crawford, Geylang Bahru, Kallang Bahru, Kampong Bugis, Kampong Java, Lavender, Tanjong Rhu</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Lim Chu Kang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Lim Chu Kang</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Mandai</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Mandai East, Mandai Estate, Mandai West</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Marina East</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Marina East</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Marina South</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Marina South</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Marine Parade</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">East Coast, Katong, Marina East (Mp), Marine Parade, Mountbatten</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Museum</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bras Basah, Dhoby Ghaut, Fort Canning</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Newton</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Cairnhill, Goodwood Park, Istana Negara, Monk's Hill, Newton Circus, Orange Grove</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">North-Eastern Islands</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">North-Eastern Islands</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Novena</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Balestier, Dunearn, Malcolm, Moulmein, Mount Pleasant</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Orchard</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Boulevard, Somerset, Tanglin</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Outram</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">China Square, Chinatown, Pearl's Hill, People's Park</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Pasir Ris</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Flora Drive, Loyang East, Loyang West, Pasir Ris Central, Pasir Ris Drive, Pasir Ris Park, Pasir Ris Wafer Fab Park, Pasir Ris West</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Paya Lebar</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Airport Road, Paya Lebar East, Paya Lebar North, Paya Lebar West, Plab</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Pioneer</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Benoi Sector, Gul Basin, Gul Circle, Joo Koon, Pioneer Sector</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Punggol</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Coney Island, Matilda, Northshore, Punggol Canal, Punggol Field, Punggol Town Centre, Waterway East</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Queenstown</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Commonwealth, Dover, Ghim Moh, Holland Drive, Kent Ridge, Margaret Drive, Mei Chin, National University Of S'pore, One North, Pasir Panjang 1, Pasir Panjang 2, Port, Queensway, Singapore Polytechnic, Tanglin Halt</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">River Valley</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Institution Hill, Leonie Hill, One Tree Hill, Oxley, Paterson</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Rochor</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bencoolen, Farrer Park, Kampong Glam, Little India, Mackenzie, Mount Emily, Rochor Canal, Selegie, Sungei Road, Victoria</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Seletar</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Pulau Punggol Barat, Pulau Punggol Timor, Seletar, Seletar Aerospace Park</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Sembawang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Admiralty, Sembawang Central, Sembawang East, Sembawang North, Sembawang Springs, Sembawang Straits, Senoko North, Senoko South, The Wharves</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Sengkang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Anchorvale, Compassvale, Fernvale, Lorong Halus North, Rivervale, Sengkang Town Centre, Sengkang West</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Serangoon</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Lorong Chuan, Seletar Hills, Serangoon Central, Serangoon Garden, Serangoon North, Serangoon North Ind Estate, Upper Paya Lebar</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Simpang</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Pulau Seletar, Simpang North, Simpang South, Tanjong Irau</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Singapore River</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Boat Quay, Clarke Quay, Robertson Quay</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Southern Islands</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Sentosa, Southern Group</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Straits View</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Straits View</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Sungei Kadut</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Gali Batu, Kranji, Pang Sua, Reservoir View, Turf Club</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Tampines</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Simei, Tampines East, Tampines North, Tampines West, Xilin</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Tanglin</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Chatsworth, Nassim, Ridout, Tyersall</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Tengah</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Brickland, Forest Hill, Garden, Park, Plantation, Tengah Industrial Estate</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Toa Payoh</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bidadari, Boon Teck, Braddell, Joo Seng, Kim Keat, Lorong 8 Toa Payoh, Pei Chun, Potong Pasir, Sennett, Toa Payoh Central, Toa Payoh West, Woodleigh</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Tuas</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Tengeh, Tuas Bay, Tuas North, Tuas Promenade, Tuas View, Tuas View Extension</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Western Islands</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Jurong Island And Bukom, Semakau, Sudong</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Western Water Catchment</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Bahar, Cleantech, Murai</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Woodlands</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Greenwood Park, Midview, North Coast, Senoko West, Woodgrove, Woodlands East, Woodlands Regional Centre, Woodlands South, Woodlands West</td></tr>\n    <tr><td headers=\"PA\" class=\"gt_row gt_left\">Yishun</td>\n<td headers=\"Subzones\" class=\"gt_row gt_left\">Khatib, Lower Seletar, Nee Soon, Northland, Springleaf, Yishun Central, Yishun East, Yishun South, Yishun West</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npyramid_data <- data %>%\n  group_by(Age, Sex) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  mutate(Pop = if_else(Sex == \"Males\", -Pop, Pop))\n\npyramid_plot <- ggplot(pyramid_data, aes(x = Age, y = Pop, fill = Sex)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_flip() +\n  scale_y_continuous(labels = abs) +\n  labs(title = \"Singapore Resident Population Pyramid (2024)\",\n       x = \"Age\", y = \"Population\") +\n  theme_minimal()\n\npyramid_plot\n```\n\n::: {.cell-output-display}\n![](Take_Home_Exercise01_part2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\nGood design principles\n\n1.  Symmetric layout: The chart clearly shows the population pyramid with a symmetrical and intuitive view of population distribution by sex and age.\n\n2.  Clean typography and grid: The distinct colors to represent females and males respectively, allows the viewers to clearly identify the different groups.\n\n3.  Clear labeling: The chart title, axis labels, and legend are all self‐explanatory.\n:::\n\n### Areas of improvement\n\n1.  Inadequate Axis Scale and Labels: The x-axis labels are difficult to read and interpret accurately. The scale could benefit from clearer labeling or formatting, such as using shorter units.\n\n2.  Lack of Age Grouping and Axis Detail: Age is listed individually (1–100), making the visualization overly granular and cluttered. Grouping ages into bins would streamline the visualization and improve readability.\n\n3.  Percentage on each single class: Adding percentage annotations within each age group to offer additional context.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Prepare data with age groups and percentage\npyramid_data <- data %>%\n  mutate(AgeGroup = cut(Age,\n                        breaks = seq(0, 100, 5),\n                        include.lowest = TRUE,\n                        right = FALSE,\n                        labels = paste(seq(0, 95, 5), seq(4, 99, 5), sep = \"-\"))) %>%\n  group_by(AgeGroup, Sex) %>%\n  summarise(Pop = sum(Pop), .groups = \"drop\") %>%\n  group_by(AgeGroup) %>%\n  mutate(TotalGroupPop = sum(Pop),\n         Percentage = round((Pop / TotalGroupPop) * 100, 1),\n         Pop = if_else(Sex == \"Males\", -Pop, Pop))\n\n# Reorder age groups\npyramid_data$AgeGroup <- factor(pyramid_data$AgeGroup, \n                                levels = rev(unique(pyramid_data$AgeGroup)))\n\n# Plotting with percentages only and adjusted positions\nggplot(pyramid_data, aes(x = AgeGroup, y = Pop, fill = Sex)) +\n  geom_bar(stat = \"identity\", width = 0.9) +\n  coord_flip() +\n  scale_y_continuous(labels = function(x) paste0(abs(x / 1000), \"K\")) +\n  labs(title = \"Singapore Resident Population Pyramid (2024)\",\n       subtitle = \"Population grouped in 5-year intervals, percentages show sex distribution within groups\",\n       x = \"Age Group\",\n       y = \"Population (Thousands)\",\n       fill = \"Sex\") +\n  theme_minimal() +\n  theme(plot.title = element_text(size = 15, face = \"bold\"),\n        plot.subtitle = element_text(size = 11),\n        axis.text = element_text(size = 9),\n        legend.position = \"bottom\") +\n  scale_fill_manual(values = c(\"Males\" = \"#00BFC4\", \"Females\" = \"#F8766D\")) +\n  geom_text(aes(label = paste0(Percentage, \"%\"),\n                hjust = if_else(Sex == \"Males\", 1.1, -0.1)),\n            size = 2,\n            color = \"black\")\n```\n\n::: {.cell-output-display}\n![](Take_Home_Exercise01_part2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take_Home_Exercise01_part2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}